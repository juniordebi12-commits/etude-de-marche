{% extends "survey/base.html" %}
{% block content %}
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<!-- AOS Animation -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css"/>

<style>
body { font-family: 'Inter', sans-serif; }

/* Modern cards */
.card {
    border-radius: 1rem;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    background: linear-gradient(135deg, #ffffff 0%, #f9f9f9 100%);
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
}
.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
}

/* Buttons hover */
.btn-see:hover { transform: scale(1.05); }
.btn-edit:hover { transform: scale(1.05); }
.btn-delete:hover { background-color: #ff4d4f; color: #fff; transform: scale(1.05); }
.btn-outline-success:hover { background-color: #28a745; color: #fff; }

/* Search input */
#search-surveys {
    max-width: 400px;
    margin-bottom: 1rem;
}
.survey-description {
    color: #555;
}

/* Responsive grid gap */
.row.g-4 { gap: 1.5rem; }
</style>

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
        <h2>üìä Liste des √©tudes de march√©</h2>
        <a href="{% url 'survey_create' %}" class="btn btn-success btn-lg mt-2">üìù Cr√©er un nouveau questionnaire</a>
    </div>

    <!-- Barre de recherche -->
    <input type="text" id="search-surveys" placeholder="üîç Rechercher un questionnaire..." class="form-control">

    {% if surveys %}
        <div class="row g-4" id="survey-cards">
            {% for survey in surveys %}
                <div class="col-md-6 col-lg-4" data-aos="fade-up">
                    <div class="card h-100 shadow-sm border-0">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">{{ survey.title }}</h5>
                            <p class="card-text survey-description mb-3">{{ survey.description|truncatechars:100 }}</p>
                            <p class="text-secondary small mb-3">
                                Cr√©√© le {{ survey.created_at|date:"d/m/Y H:i" }}<br>
                                {% if survey.updated_at > survey.created_at %}
                                Modifi√© le : {{ survey.updated_at|date:"d/m/Y H:i" }}
                                {% endif %}
                            </p>
                            <div class="mt-auto d-flex justify-content-between flex-wrap gap-2">
                                <a href="{% url 'survey_detail' survey.id %}" class="btn btn-info btn-see">Voir</a>
                                <a href="{% url 'survey_summary' survey.id %}" class="btn btn-outline-success">R√©sum√©</a>
                                <a href="{% url 'survey_edit' survey.id %}" class="btn btn-warning btn-edit">Modifier</a>
                                <a href="{% url 'survey_delete' survey.id %}" class="btn btn-danger btn-delete">Supprimer</a>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center mt-5">
            <h4>Aucune √©tude de march√© disponible pour le moment üòî</h4>
            <p>Commencez par cr√©er votre premier questionnaire !</p>
            <a href="{% url 'survey_create' %}" class="btn btn-success btn-lg">üìù Cr√©er un questionnaire</a>
        </div>
    {% endif %}
</div>

<!-- AOS JS -->
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
<script>
  AOS.init({ duration: 800, once: true });

  // Filtrage temps r√©el
  const searchInput = document.getElementById('search-surveys');
  searchInput.addEventListener('input', () => {
    const query = searchInput.value.toLowerCase();
    document.querySelectorAll('#survey-cards .col-md-6').forEach(card => {
        const title = card.querySelector('.card-title').textContent.toLowerCase();
        card.style.display = title.includes(query) ? 'block' : 'none';
    });
  });
</script>

{% endblock %}
